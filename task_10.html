<!DOCTYPE html>
<html>
<head>
  <title>JavaScript: Course for DXStudents</title>
</head>
<style>
  .circle{
    border-radius: 100%;
    width: 100px;
    height: 100px;
  }
  .circleGray{
    background: gray;
  }
  .circleGreen{
    background: green;
  }
  .circleYellow{
    background: yellow;
  }
  .circleRed{
    background: red;
  }
</style>

<body>
  <h2>JS Traffic Light</h2>
  <p>
    <b><span style="font-size: 20px;">Task: </span></b> 
    <br>Create a simple traffic light component using pure JavaScript. The application should contain:
    <ul style="list-style-type: decimal;">
      <li>A simple traffic light with 3 circles.
        <br>Circles and the traffic light container should be rendered in using JS <b>without</b> using <b>canvas</b> or <b>image</b>  
        <br>Use CSS classes to customize traffic light appearance
      </li>
      <li>The traffic light should be two modes:
        <br>Manual mode - lights can be switched on a button click  
        <br>Automatic mode - lights can be switches automatically
      </li>  
      <li>The task should be implemented in two ways - using <a href="https://www.w3schools.com/js/js_object_constructors.asp">JavaScript functions</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">ES6 classes</a>. The resulting archive should contain both implementations.
      </li>
    </ul>  
  </p>
  <br>

  <div id="mcxCircleGreen" class="circle circleGray"></div><br>
  <div id="mcxCircleYelow" class="circle circleGray"></div><br>
  <div id="mcxCircleRed" class="circle circleGray"></div>
  <br><br>
  <button id="mcxBtn">Change the light</button>
  <br><br>
  <button id="mcxBtnTimer">Tubr ON / OFF changing the light by timer</button>


  <br><br><br>
  <div id="mcxCircleGreen2" class="circle circleGreen"></div><br>
  <div id="mcxCircleYelow2" class="circle circleGray"></div><br>
  <div id="mcxCircleRed2" class="circle circleGray"></div>
  <br><br>
  <button id="mcxBtn2">Change the light</button>
  <br><br>
  <button id="mcxBtnTimer2">Tubr ON / OFF changing the light by timer</button>

  <script>
    const greenCircle = document.getElementById("mcxCircleGreen");
    const yellowCircle = document.getElementById("mcxCircleYelow");
    const redCircle = document.getElementById("mcxCircleRed");

    const btn = document.getElementById("mcxBtn");
    const btnTimer = document.getElementById("mcxBtnTimer");
    const btn2 = document.getElementById("mcxBtn2");
    const btnTimer2 = document.getElementById("mcxBtnTimer2");

    function TrafficLight() { 
      this.index = 0;
    }

    TrafficLight.prototype.lightIndex = function() { return this.index % 3};
    TrafficLight.prototype.activeLight = function() {
      switch (this.lightIndex()) {
        case 0: 
          greenCircle.classList.replace("circleGray", "circleGreen");
          redCircle.classList.replace("circleRed", "circleGray");
        break;
        case 1: 
          greenCircle.classList.replace("circleGreen", "circleGray");
          yellowCircle.classList.replace("circleGray", "circleYellow");
        break;
        case 2:
          yellowCircle.classList.replace("circleYellow", "circleGray");
          redCircle.classList.replace("circleGray", "circleRed");
        break;                
      }
    }  
    TrafficLight.prototype.changeLight = function() {  
      this.index += 1;
      this.activeLight();
    }  

    const myTrafficLight = new TrafficLight();
    myTrafficLight.activeLight();

    // Classes
    class ClassTrafficLight {
      constructor (Circle1Id, Circle2Id, Circle3Id) {
        this.Circle1 = document.getElementById(Circle1Id);
        this.Circle2 = document.getElementById(Circle2Id);
        this.Circle3 = document.getElementById(Circle3Id);
      } 

      activeCircle = 0;

      toggleColors(Circle, Style1, Style2) {
        if (Circle.classList.contains(Style1)) {
          Circle.classList.remove(Style1);
          Circle.classList.add(Style2);
        }
      }

      changeActiveCircle(){
        this.activeCircle = (this.activeCircle + 1) % 3;
        switch (this.activeCircle) {
        case 0: 
          this.toggleColors(this.Circle1, "circleGray", "circleGreen");
          this.toggleColors(this.Circle3, "circleRed", "circleGray");
        break;
        case 1: 
          this.toggleColors(this.Circle1, "circleGreen", "circleGray");
          this.toggleColors(this.Circle2, "circleGray", "circleYellow");
        break;
        case 2:
          this.toggleColors(this.Circle2, "circleYellow", "circleGray");
          this.toggleColors(this.Circle3, "circleGray", "circleRed");
        break;                
      }
    }
  }  

    let objTrafficLight = new ClassTrafficLight("mcxCircleGreen2", "mcxCircleYelow2", "mcxCircleRed2");

    let timerId = 0;
    let flag = false;

    // manual switch
    btn.onclick = function() {
      flag = false;
      clearTimeout(timerId);
      myTrafficLight.changeLight();
    };

    // auto switch  
    btnTimer.onclick = function() {
      flag = !flag;
      if (flag) {  
        timerId = setInterval(
        () => myTrafficLight.changeLight(), 1000
        );
      }
      else
        clearTimeout(timerId);
    };

    let timerId2 = 0;
    let flag2 = false;

    // manual switch
    btn2.onclick = function() {
      flag2 = false;
      clearTimeout(timerId2);
      objTrafficLight.changeActiveCircle();
    };

    // auto switch  
    btnTimer2.onclick = function() {
       flag2 = !flag2;
       if (flag2) {  
         timerId2 = setInterval(
         () => objTrafficLight.changeActiveCircle(), 500
         );
       }
       else
         clearTimeout(timerId2);
    };    
  </script>
</body>
</html>